<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Execute Strategus • Strategus</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Execute Strategus">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Strategus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/CreatingAnalysisSpecification.html">Creating Analysis Specification</a></li>
    <li><a class="dropdown-item" href="../articles/ExecuteStrategus.html">Execute Strategus</a></li>
    <li><a class="dropdown-item" href="../articles/IntroductionToStrategus.html">Introduction to Strategus</a></li>
    <li><a class="dropdown-item" href="../articles/WorkingWithResults.html">Working With Results</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="../results-schema/index.html">Results model documentation</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://ohdsi.github.io/Hades">hadesLogo</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/OHDSI/Strategus/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Execute Strategus</h1>
                        <h4 data-toc-skip class="author">Anthony G.
Sena</h4>
            
            <h4 data-toc-skip class="date">2024-10-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/OHDSI/Strategus/blob/update-docs/vignettes/ExecuteStrategus.Rmd" class="external-link"><code>vignettes/ExecuteStrategus.Rmd</code></a></small>
      <div class="d-none name"><code>ExecuteStrategus.Rmd</code></div>
    </div>

    
    
<p>A Strategus study is defined by <em>analysis specifications</em>.
These specifications describe which modules to run, with which settings.
The <a href="CreatingAnalysisSpecification.Rmd">Creating Analysis
Specification</a> vignette describes how to create analysis
specifications. In this vignette, we demonstrate how to run a study once
it is specified.</p>
<div class="section level2">
<h2 id="creating-execution-settings">Creating execution settings<a class="anchor" aria-label="anchor" href="#creating-execution-settings"></a>
</h2>
<p>In addition to analysis specifications, Strategus also requires
<em>execution settings</em>. The execution settings specify how the
study should be executed in a specific environment, for example how to
connect to a database, and what local folders to use. Many Strategus
studies run against data in the OMOP Common Data Model (CDM), and in
this vignette we focus on this type of studies. (Other studies, such as
meta-analyses, may run against results data instead). In this example,
we will make use of the <a href="https://github.com/ohdsi/eunomia" class="external-link">Eunomia</a> data set which is an
OMOP CDM with simulated data used for example purposes. When running a
study against your own CDM data, you will need to specify the database
connection details for your environment. Execution settings for studies
against the CDM can be created using
<code><a href="../reference/createCdmExecutionSettings.html">createCdmExecutionSettings()</a></code>.</p>
<div class="section level3">
<h3 id="creating-the-connection-details">Creating the connection details<a class="anchor" aria-label="anchor" href="#creating-the-connection-details"></a>
</h3>
<p>In this example, we first create a <code>connectionDetails</code> for
Eunomia. In your environment, the <code>connectionDetails</code> would
be specific to your OMOP CDM. Please see the <a href="https://ohdsi.github.io/DatabaseConnector/articles/Connecting.html" class="external-link">DatabaseConnector</a>
package documentation for more details.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ohdsi.github.io/Strategus">Strategus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/OHDSI/Eunomia" class="external-link">Eunomia</a></span><span class="op">)</span></span>
<span><span class="va">connectionDetails</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Eunomia/man/getEunomiaConnectionDetails.html" class="external-link">getEunomiaConnectionDetails</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="creating-an-execution-settings-object">Creating an execution settings object<a class="anchor" aria-label="anchor" href="#creating-an-execution-settings-object"></a>
</h3>
<p>Next, we will use <code>Strategus</code> to create the CDM execution
settings:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outputFolder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="st">"vignetteFolder"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">outputFolder</span><span class="op">)</span></span>
<span><span class="va">executionSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createCdmExecutionSettings.html">createCdmExecutionSettings</a></span><span class="op">(</span></span>
<span>  workDatabaseSchema <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  cdmDatabaseSchema <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  cohortTableNames <span class="op">=</span> <span class="fu">CohortGenerator</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/CohortGenerator/reference/getCohortTableNames.html" class="external-link">getCohortTableNames</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  workFolder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">outputFolder</span>, <span class="st">"work_folder"</span><span class="op">)</span>,</span>
<span>  resultsFolder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">outputFolder</span>, <span class="st">"results_folder"</span><span class="op">)</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Finally, we can write out the execution settings to the file system
to capture this information.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ParallelLogger</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/ParallelLogger/reference/saveSettingsToJson.html" class="external-link">saveSettingsToJson</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">executionSettings</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">outputFolder</span>, <span class="st">"eunomiaExecutionSettings.json"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="executing-the-study">Executing the study<a class="anchor" aria-label="anchor" href="#executing-the-study"></a>
</h2>
<div class="section level3">
<h3 id="specifying-the-instantiated-modules-folder">Specifying the instantiated modules folder<a class="anchor" aria-label="anchor" href="#specifying-the-instantiated-modules-folder"></a>
</h3>
<p>For this study, we will use analysis specifications created
elsewhere, and the execution settings we created earlier:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analysisSpecifications</span> <span class="op">&lt;-</span> <span class="fu">ParallelLogger</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/ParallelLogger/reference/loadSettingsFromJson.html" class="external-link">loadSettingsFromJson</a></span><span class="op">(</span></span>
<span>  fileName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"testdata/cdmModulesAnalysisSpecifications.json"</span>,</span>
<span>    package <span class="op">=</span> <span class="st">"Strategus"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">executionSettings</span> <span class="op">&lt;-</span> <span class="fu">ParallelLogger</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/ParallelLogger/reference/loadSettingsFromJson.html" class="external-link">loadSettingsFromJson</a></span><span class="op">(</span></span>
<span>  fileName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">outputFolder</span>, <span class="st">"eunomiaExecutionSettings.json"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>And finally we execute the study:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/execute.html">execute</a></span><span class="op">(</span></span>
<span>  connectionDetails <span class="op">=</span> <span class="va">connectionDetails</span>,</span>
<span>  analysisSpecifications <span class="op">=</span> <span class="va">analysisSpecifications</span>,</span>
<span>  executionSettings <span class="op">=</span> <span class="va">executionSettings</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This will first instantiate all the modules if they haven’t already
been instantiated, and will then execute each module in sequence
according to the analysis specifications. The results will appear in
subfolders of the ‘results_folder’, as specified in the execution
settings.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anthony Sena, Martijn Schuemie, Jamie Gilbert.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
