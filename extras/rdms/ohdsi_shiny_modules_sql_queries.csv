"fileName","startLine","endLine","sqlQuery"
"characterization-caseSeries.R","195","224","SELECT distinct s.database_id, d.CDM_SOURCE_ABBREVIATION as database_name,s.setting_id, s.RISK_WINDOW_START,	s.RISK_WINDOW_END, s.START_ANCHOR, s.END_ANCHOR, ct1.cohort_name as target_name, ct2.cohort_name as outcome_name  from @schema.@c_table_prefixsettings s inner join @schema.@database_meta_table d on s.database_id = d.database_id inner join @schema.@c_table_prefixcohort_details cd on s.setting_id = cd.setting_id and s.database_id = cd.database_id and cd.target_cohort_id = @target_id and cd.outcome_cohort_id = @outcome_id and cd.cohort_type = 'Cases'  inner join @schema.@cg_table_prefixcohort_definition ct1 on ct1.cohort_definition_id = cd.target_cohort_id  inner join @schema.@cg_table_prefixcohort_definition ct2 on ct2.cohort_definition_id = cd.outcome_cohort_id     ;"
"characterization-caseSeries.R","275","306","SELECT case when cov.cohort_type = 'CasesBefore' then 'Before' when cov.cohort_type = 'CasesBetween' then 'During' when cov.cohort_type = 'CaseAfter' then 'After' end as type, cr.covariate_name, s.min_prior_observation, s.outcome_washout_days, s.case_post_outcome_duration, s.case_pre_target_duration, cov.covariate_id, cov.sum_value, cov.average_value from @schema.@c_table_prefixcovariates cov inner join  @schema.@c_table_prefixcovariate_ref cr on cov.setting_id = cr.setting_id and cov.database_id = cr.database_id and cov.covariate_id = cr.covariate_id  inner join @schema.@c_table_prefixsettings s on cov.setting_id = s.setting_id and cov.database_id = s.database_id  where cov.target_cohort_id = @target_id and cov.outcome_cohort_id = @outcome_id and cov.cohort_type in ('CasesBetween','CasesAfter','CasesBefore') --and cov.setting_id = @setting_id and s.risk_window_start = @risk_window_start and s.risk_window_end = @risk_window_end and s.start_anchor = '@start_anchor' and s.end_anchor = '@end_anchor' and cov.database_id = '@database_id' and cr.analysis_id in (109, 110, 217, 218, 305, 417, 418, 505, 605, 713, 805, 926, 927)   ;"
"characterization-caseSeries.R","328","361","SELECTcase when cov.cohort_type = 'CasesBefore' then 'Before' when cov.cohort_type = 'CasesBetween' then 'During' when cov.cohort_type = 'CasesAfter' then 'After' end as type, cr.covariate_name, s.min_prior_observation, s.outcome_washout_days, s.case_post_outcome_duration, s.case_pre_target_duration, cov.covariate_id, cov.count_value, cov.min_value, cov.max_value, cov.average_value, cov.standard_deviation, cov.median_value, cov.p_10_value, cov.p_25_value, cov.p_75_value, cov.p_90_value from @schema.@c_table_prefixcovariates_continuous cov inner join  @schema.@c_table_prefixcovariate_ref cr on cov.setting_id = cr.setting_id and cov.database_id = cr.database_id and cov.covariate_id = cr.covariate_id  inner join @schema.@c_table_prefixsettings s on cov.setting_id = s.setting_id and cov.database_id = s.database_id  where cov.target_cohort_id = @target_id and cov.outcome_cohort_id = @outcome_id and cov.cohort_type in ('CasesBetween','CasesAfter','CasesBefore') and s.risk_window_start = @risk_window_start and s.risk_window_end = @risk_window_end and s.start_anchor = '@start_anchor' and s.end_anchor = '@end_anchor' and cov.database_id = '@database_id' and cr.analysis_id in (109, 110, 217, 218, 305, 417, 418, 505, 605, 713, 805, 926, 927)   ;"
"characterization-cohorts.R","791","810","select  ref.covariate_name, s.min_prior_observation, cov.target_cohort_id as cohort_definition_id, cov.* from @schema.@c_table_prefixCOVARIATES cov inner join @schema.@c_table_prefixcovariate_ref ref on cov.covariate_id = ref.covariate_id and cov.setting_id = ref.setting_id and cov.database_id = ref.database_id inner join @schema.@c_table_prefixsettings s on s.database_id = cov.database_id and s.setting_id = cov.setting_id  where cov.target_cohort_id in (@target_ids) and cov.cohort_type = 'Target' AND cov.database_id in (@database_ids)     AND cov.average_value >= @min_threshold;"
"characterization-cohorts.R","902","925","select  ref.covariate_name, s.min_prior_observation, cov.target_cohort_id as cohort_definition_id, cov.*, d.CDM_SOURCE_ABBREVIATION as database_name  from @schema.@c_table_prefixCOVARIATES_continuous cov inner join @schema.@c_table_prefixcovariate_ref ref on cov.covariate_id = ref.covariate_id and cov.setting_id = ref.setting_id and cov.database_id = ref.database_id inner join @schema.@c_table_prefixsettings s on cov.setting_id = s.setting_id and cov.database_id = s.database_id inner join @schema.@database_meta_table d on s.database_id = d.database_id  where cov.target_cohort_id in (@target_ids) and cov.cohort_type = 'Target'     AND cov.database_id in (@database_ids);"
"characterization-cohorts.R","990","999","select distinct d.database_id, d.cdm_source_abbreviation as database_name from @schema.@database_table d  inner join @schema.@c_table_prefixcohort_details cd on d.database_id = cd.database_id where cd.target_cohort_id = @target_id and cd.cohort_type = 'Target'   ;"
"characterization-dechallengeRechallenge.R","329","337","SELECT DISTINCT t.COHORT_NAME as target, dr.TARGET_COHORT_DEFINITION_ID, o.COHORT_NAME as outcome, dr.OUTCOME_COHORT_DEFINITION_ID FROM @schema.@c_table_prefixDECHALLENGE_RECHALLENGE dr inner join @schema.@cg_table_prefixCOHORT_DEFINITION t on dr.TARGET_COHORT_DEFINITION_ID = t.COHORT_DEFINITION_ID inner join @schema.@cg_table_prefixCOHORT_DEFINITION o on dr.OUTCOME_COHORT_DEFINITION_ID = o.COHORT_DEFINITION_ID   ;"
"characterization-dechallengeRechallenge.R","390","395","SELECT distinct d.CDM_SOURCE_ABBREVIATION as database_name, dr.*FROM @schema.@c_table_prefixDECHALLENGE_RECHALLENGE dr inner join @schema.@database_table d on dr.database_id = d.database_id where dr.TARGET_COHORT_DEFINITION_ID = @target_id           and dr.OUTCOME_COHORT_DEFINITION_ID = @outcome_id;"
"characterization-dechallengeRechallenge.R","433","438","SELECT * FROM @schema.@c_table_prefixRECHALLENGE_FAIL_CASE_SERIES where TARGET_COHORT_DEFINITION_ID = @target_id and OUTCOME_COHORT_DEFINITION_ID = @outcome_id and DATABASE_ID = '@database_id' and DECHALLENGE_STOP_INTERVAL = @dechallenge_stop_interval           and DECHALLENGE_EVALUATION_WINDOW = @dechallenge_evaluation_window;"
"characterization-dechallengeRechallenge.R","476","480","SELECT cc.database_id, cc.cohort_id, cc.cohort_entries, cc.cohort_subjects FROM @schema.@cg_table_prefixCOHORT_COUNT cc where cc.cohort_id = @cohort_id   ;"
"characterization-incidence.R","1702","1724","select d.cdm_source_abbreviation, i.*, ct1.cohort_name as target_name, ct2.cohort_name as outcome_namefrom ( select od.outcome_cohort_definition_id, od.clean_window, agd.age_group_name, tad.tar_start_with, tad.tar_start_offset, tad.tar_end_with, tad.tar_end_offset, sd.subgroup_name, i.* from @result_schema.@incidence_table_prefixINCIDENCE_SUMMARY i join @result_schema.@incidence_table_prefixOUTCOME_DEF od on i.outcome_id = od.outcome_id and i.ref_id = od.ref_id join @result_schema.@incidence_table_prefixTAR_DEF tad on i.tar_id = tad.tar_id and i.ref_id = tad.ref_id join @result_schema.@incidence_table_prefixSUBGROUP_DEF sd on i.subgroup_id = sd.subgroup_id and i.ref_id = sd.ref_id left join @result_schema.@incidence_table_prefixAGE_GROUP_DEF agd on i.age_group_id = agd.age_group_id and i.ref_id = agd.ref_id ) i inner join @result_schema.@database_table_name d on d.database_id = i.database_id inner join @result_schema.@cg_table_prefixcohort_definition ct1 on ct1.cohort_definition_id = i.target_cohort_definition_id inner join @result_schema.@cg_table_prefixcohort_definition ct2 on ct2.cohort_definition_id = i.outcome_cohort_definition_id where i.target_cohort_definition_id in (@target_ids)   and i.outcome_cohort_definition_id in (@outcome_ids);"
"characterization-incidence.R","1800","1803","select outcome_id, outcome_name from @result_schema.@incidence_table_prefixOUTCOME_DEF"
"characterization-incidence.R","1879","1881","SELECT TAR_ID, TAR_START_WITH, TAR_START_OFFSET,TAR_END_WITH, TAR_END_OFFSET           from @schema.@ci_table_prefixtar_def;"
"characterization-riskFactors.R","208","225","SELECT cohort_type, min_prior_observation, outcome_washout_days, row_count, person_count  from @schema.@c_table_prefixcohort_counts where database_id = '@database_id' and target_cohort_id = @target_id and outcome_cohort_id in (@outcome_id, 0) and (risk_window_start = @risk_window_start OR risk_window_start is NULL) and (risk_window_end = @risk_window_end OR risk_window_end is NULL) and (start_anchor = '@start_anchor' OR start_anchor is NULL) and (end_anchor = '@end_anchor' OR end_anchor is NULL) and cohort_type in ('Cases','Exclude','Target')   ;"
"characterization-riskFactors.R","256","272","SELECT distinct setting_idfrom @schema.@c_table_prefixsettings where database_id = '@database_id' and risk_window_start = @risk_window_start and risk_window_end = @risk_window_end and start_anchor = '@start_anchor' and end_anchor = '@end_anchor'  union  SELECT distinct setting_id from @schema.@c_table_prefixsettings where database_id = '@database_id' and risk_window_start is NULL   ;"
"characterization-riskFactors.R","287","308","SELECT distinct cov.cohort_type, cr.covariate_name, s.min_prior_observation, s.outcome_washout_days, cov.covariate_id, cov.sum_value, cov.average_value from @schema.@c_table_prefixcovariates cov inner join  @schema.@c_table_prefixcovariate_ref cr on cov.setting_id = cr.setting_id and cov.database_id = cr.database_id and cov.covariate_id = cr.covariate_id  inner join @schema.@c_table_prefixsettings s on cov.setting_id = s.setting_id and cov.database_id = s.database_id  where cov.target_cohort_id = @target_id and cov.outcome_cohort_id in (0,@outcome_id) and cov.cohort_type in ('Target','Cases', 'Exclude') and cov.database_id = '@database_id' and cov.setting_id in (@setting_ids) and cr.analysis_id not in (109, 110, 217, 218, 305, 417, 418, 505, 605, 713, 805, 926, 927)   ;"
"characterization-riskFactors.R","328","350","SELECT distinct cov.cohort_type, cr.covariate_name, s.min_prior_observation, s.outcome_washout_days,cov.covariate_id, cov.count_value, cov.min_value, cov.max_value, cov.average_value, cov.standard_deviation, cov.median_value, cov.p_10_value, cov.p_25_value, cov.p_75_value, cov.p_90_value from @schema.@c_table_prefixcovariates_continuous cov inner join  @schema.@c_table_prefixcovariate_ref cr on cov.setting_id = cr.setting_id and cov.database_id = cr.database_id and cov.covariate_id = cr.covariate_id  inner join @schema.@c_table_prefixsettings s on cov.setting_id = s.setting_id and cov.database_id = s.database_id  where cov.target_cohort_id = @target_id and cov.outcome_cohort_id in (0,@outcome_id) and cov.cohort_type in ('Target','Cases', 'Exclude') and cov.database_id = '@database_id' and cov.setting_id in (@setting_ids) and cr.analysis_id not in (109, 110, 217, 218, 305, 417, 418, 505, 605, 713, 805, 926, 927)   ;"
"characterization-timeToEvent.R","265","270","SELECT tte.*, d.CDM_SOURCE_ABBREVIATION as database_name FROM @schema.@c_table_prefixTIME_TO_EVENT tte inner join @schema.@database_table d on tte.database_id = d.database_id where tte.TARGET_COHORT_DEFINITION_ID = @target_id           and tte.OUTCOME_COHORT_DEFINITION_ID = @outcome_id;"
"cohort-diagnostics-characterization.R","923","933","SELECT @select_stament  FROM @results_database_schema.@table_prefixtemporal_covariate_ref tcr INNER JOIN @results_database_schema.@table_prefixtemporal_analysis_ref tar ON tar.analysis_id = tcr.analysis_id LEFT JOIN @results_database_schema.@table_prefixtemporal_covariate_value tcv ON ( tcr.covariate_id = tcv.covariate_id ) LEFT JOIN @results_database_schema.@table_prefixtemporal_time_ref ttr ON ttr.time_id = tcv.time_id WHERE tcr.covariate_id IS NOT NULL"
"cohort-diagnostics-conceptsInDataSource.R","80","117","SELECT concepts.*,c.concept_name, c.vocabulary_id, c.domain_id, c.standard_concept, c.concept_code FROM ( SELECT isc.database_id, isc.cohort_id, isc.concept_id, 0 source_concept_id, max(concept_subjects) concept_subjects, sum(concept_count) concept_count FROM @schema.@table_name isc WHERE isc.cohort_id = @cohort_id AND isc.database_id IN (@database_ids) GROUP BY isc.database_id, isc.cohort_id, isc.concept_id  UNION  SELECT c.database_id, c.cohort_id, c.source_concept_id as concept_id, 1 source_concept_id, max(c.concept_subjects) concept_subjects, sum(c.concept_count) concept_count FROM @schema.@table_name c WHERE c.cohort_id = @cohort_id AND c.database_id IN (@database_ids) GROUP BY c.database_id, c.cohort_id, c.source_concept_id ) concepts INNER JOIN @schema.@concept_table c ON concepts.concept_id = c.concept_id             WHERE c.invalid_reason IS NULL;"
"cohort-diagnostics-databaseInformation.R","61","63","SELECT *FROM  @schema.@metadata               WHERE database_id = @database_id;"
"cohort-diagnostics-definition.R","213","214","SELECT * FROM @schema.@cohort_table    WHERE cohort_id IN (@cohort_ids)"
"cohort-diagnostics-definition.R","447","450","SELECT ics.*FROM  @schema.@table_name ics WHERE ics.cohort_id = @cohort_id              AND database_id in (@database_ids);"
"cohort-diagnostics-incidenceRates.R","20","20","SELECT DISTINCT age_group FROM @schema.@ir_table WHERE person_years >= @person_years"
"cohort-diagnostics-incidenceRates.R","31","31","SELECT DISTINCT calendar_year FROM @schema.@ir_table WHERE person_years >= @person_years"
"cohort-diagnostics-incidenceRates.R","45","45","SELECT DISTINCT gender FROM @schema.@ir_table WHERE person_years >= @person_years"
"cohort-diagnostics-incidenceRates.R","57","63","SELECTmin(incidence_rate) as min_ir, max(incidence_rate) as max_ir FROM @schema.@ir_table WHERE person_years >= @person_years AND incidence_rate > 0.0"
"cohort-diagnostics-incidenceRates.R","118","128","SELECT ir.*, cc.cohort_subjectsFROM  @schema.@ir_table ir INNER JOIN @schema.@cc_table cc ON ( ir.database_id = cc.database_id AND ir.cohort_id = cc.cohort_id ) WHERE ir.cohort_id in (@cohort_ids) AND ir.database_id in (@database_ids) {@gender == TRUE} ? {AND ir.gender IS NOT NULL} : {  AND ir.gender IS NULL} {@age_group == TRUE} ? {AND ir.age_group IS NOT NULL} : {  AND ir.age_group IS NULL} {@calendar_year == TRUE} ? {AND ir.calendar_year IS NOT NULL} : {  AND ir.calendar_year IS NULL}               AND ir.person_years > @personYears;"
"cohort-diagnostics-indexEventBreakdown.R","99","109","SELECT index_event_breakdown.*,concept.concept_name, concept.domain_id, concept.vocabulary_id, concept.standard_concept, concept.concept_code FROM  @schema.@table_name index_event_breakdown INNER JOIN  @vocabulary_database_schema.@concept_table concept ON index_event_breakdown.concept_id = concept.concept_id WHERE database_id in (@database_id)               AND cohort_id in (@cohort_ids);"
"cohort-diagnostics-main.R","19","19","SELECT table_name FROM information_schema.tables where table_schema = '@schema'"
"cohort-diagnostics-main.R","83","83","SELECT * FROM @schema.@table LIMIT 1"
"cohort-diagnostics-main.R","101","109","select c.relname as table_name from pg_class c inner join pg_namespace n on n.oid = c.relnamespace where c.relkind = 'r' and n.nspname not in ('information_schema','pg_catalog') and c.reltuples != 0 and n.nspname = '@schema'"
"cohort-diagnostics-main.R","366","367","SELECT *            FROM @schema.@table_name;"
"cohort-diagnostics-orphanConcepts.R","129","153","SELECT c.concept_id, c.concept_name, c.vocabulary_id, c.concept_code, CASE WHEN c.standard_concept = 'S' THEN 'Standard' ELSE 'Non-standard' END as standard_concept %s FROM  @schema.@orphan_table_name oc INNER JOIN  @schema.@cs_table_name cs ON oc.cohort_id = cs.cohort_id AND oc.concept_set_id = cs.concept_set_id INNER JOIN  @vocabulary_database_schema.@concept_table c ON oc.concept_id = c.concept_id WHERE oc.cohort_id = @cohort_id AND database_id in (@database_ids) {@search_str != ''} ? {AND lower(CONCAT(c.concept_id, c.concept_name, c.vocabulary_id, c.concept_code)) LIKE lower('%%@search_str%%')} {@use_concept_set_id} ? { AND oc.concept_set_id IN (@concept_set_id)} GROUP BY c.concept_id, c.concept_name, c.vocabulary_id, c.concept_code, c.standard_concept     {@sort_by != \"
"cohort-diagnostics-shared.R","93","99","SELECT cc.*, db.database_name#          FROM  @schema.@table_name cc #          INNER JOIN @schema.@database_table db ON db.database_id = cc.database_id #          WHERE cc.cohort_id IS NOT NULL #          {@use_database_ids} ? { AND cc.database_id in (@database_ids)} #          {@cohort_ids != ''} ? {  AND cc.cohort_id in (@cohort_ids)}   #          ;"
"cohort-diagnostics-shared.R","101","106","SELECT cc.*FROM  @schema.@table_name cc WHERE cc.cohort_id IS NOT NULL {@use_database_ids} ? { AND cc.database_id in (@database_ids)} {@cohort_ids != ''} ? {  AND cc.cohort_id in (@cohort_ids)}             ;"
"cohort-diagnostics-shared.R","129","131","SELECT *FROM  @schema.@database_table               WHERE database_id in (@database_ids);"
"cohort-diagnostics-shared.R","986","990","SELECT *FROM  @schema.@table_name WHERE database_id in (@database_id) {@cohort_ids != ''} ? {  AND cohort_id in (@cohort_ids)}     ;"
"cohort-diagnostics-visitContext.R","91","97","SELECT visit_context.*,standard_concept.concept_name AS visit_concept_name FROM  @schema.@table_name visit_context INNER JOIN  @vocabulary_database_schema.@concept_table standard_concept ON visit_context.visit_concept_id = standard_concept.concept_id WHERE database_id in (@database_id)               AND cohort_id in (@cohort_ids);"
"cohort-generator-main.R","643","650","SELECT cc.cohort_id, cc.cohort_entries, cc.cohort_subjects,dt.cdm_source_name, cd.cohort_name FROM @schema.@cg_table_prefixCOHORT_COUNT cc join @schema.@database_table_prefix@database_table dt on cc.database_id = dt.database_id join @schema.@cg_table_prefixCOHORT_DEFINITION cd on cd.cohort_definition_id = cc.cohort_id   ;"
"cohort-generator-main.R","667","672","SELECT cg.cohort_id, cg.cohort_name,cg.generation_status, cg.start_time, cg.end_time, dt.cdm_source_name from @schema.@cg_table_prefixCOHORT_GENERATION cg join @schema.@database_table_prefix@database_table dt on cg.database_id = dt.database_id   ;"
"cohort-generator-main.R","708","715","SELECT css.cohort_definition_id, css.base_count, css.final_count, css.mode_id,dt.cdm_source_name, cd.cohort_name FROM @schema.@cg_table_prefixCOHORT_SUMMARY_STATS css join @schema.@database_table_prefix@database_table dt on css.database_id = dt.database_id join @schema.@cg_table_prefixCOHORT_DEFINITION cd on cd.cohort_definition_id = css.cohort_definition_id   ;"
"cohort-generator-main.R","734","738","SELECT ci.cohort_definition_id, ci.rule_sequence, ci.name as rule_name,cd.cohort_name FROM @schema.@cg_table_prefixCOHORT_INCLUSION ci join @schema.@cg_table_prefixCOHORT_DEFINITION cd on cd.cohort_definition_id = ci.cohort_definition_id   ;"
"cohort-generator-main.R","753","757","SELECT cir.database_id, cir.cohort_definition_id, cir.inclusion_rule_mask, cir.person_count, cir.mode_id,dt.cdm_source_name FROM @schema.@cg_table_prefixCOHORT_INC_RESULT cir join @schema.@database_table_prefix@database_table dt on cir.database_id = dt.database_id   ;"
"data-diagnostic-drill.R","254","255","SELECT * FROM @schema.@dd_table_prefixdata_diagnostics_output  WHERE analysis_name = '@analysis_name' and database_id = '@database_id';"
"data-diagnostic-drill.R","276","276","SELECT distinct database_id FROM @schema.@dd_table_prefixdata_diagnostics_summary;"
"data-diagnostic-drill.R","303","304","SELECT * FROM @schema.@dd_table_prefixdata_diagnostics_summary  WHERE analysis_name in ('@analysis');"
"data-diagnostic-drill.R","333","334","SELECT distinct database_id FROM @schema.@dd_table_prefixdata_diagnostics_summary  WHERE analysis_name in ('@analysis');"
"data-diagnostic-summary.R","145","146","SELECT distinct sum.analysis_name     FROM @schema.@dd_table_prefixdata_diagnostics_summary as sum;"
"data-diagnostic-summary.R","169","176","SELECT distinct sum.analysis_id, sum.analysis_name, sum.database_id, sum.total_fails  FROM @schema.@dd_table_prefixdata_diagnostics_summary as sum     where sum.analysis_name in (@names);"
"datasources-main.R","192","193","SELECT * from @schema.@database_table  ;"
"estimation-cohort-method-attrition.R","120","130","SELECT cmat.* FROM @schema.@cm_table_prefixattrition cmat WHERE cmat.target_id = @target_id AND cmat.comparator_id = @comparator_id AND cmat.outcome_id = @outcome_id AND cmat.analysis_id = @analysis_id AND cmat.database_id = '@database_id';"
"estimation-cohort-method-covariateBalance.R","330","334","select distinct d.cdm_source_abbreviation, i.database_id from @result_schema.@cm_table_prefixCOVARIATE_BALANCE i inner join @result_schema.@database_table_name d on d.database_id = i.database_id     ;"
"estimation-cohort-method-covariateBalance.R","359","380","SELECT cmscb.database_id, cmc.covariate_name, --cmc.analysis_id analysis_id, cmscb.target_mean_before before_matching_mean_treated, cmscb.comparator_mean_before before_matching_mean_comparator, abs(cmscb.std_diff_before) abs_before_matching_std_diff, --absBeforeMatchingStdDiff cmscb.target_mean_after after_matching_mean_treated, cmscb.comparator_mean_after after_matching_mean_comparator, abs(cmscb.std_diff_after) abs_after_matching_std_diff FROM @results_schema.@cm_table_prefixshared_covariate_balance cmscb JOIN @results_schema.@cm_table_prefixcovariate cmc ON cmscb.covariate_id = cmc.covariate_id AND cmscb.analysis_id = cmc.analysis_id AND cmscb.database_id = cmc.database_id -- database_id optional -- JOIN @results_schema.@cm_table_prefixcovariate_analysis cmca ON cmca.analysis_id = cmc.analysis_id  -- question: shouldn't we have a covariate_analysis_id in @table_prefixcovariate table? WHERE cmscb.target_id = @target_id AND cmscb.comparator_id = @comparator_id AND cmscb.analysis_id = @analysis_id --AND cmc.covariate_analysis_id = @covariate_analysis_id AND cmscb.database_id = '@database_id'"
"estimation-cohort-method-covariateBalance.R","601","602","select distinct covariate_analysis_id, covariate_analysis_name   from @result_schema.@cm_table_prefixCOVARIATE_ANALYSIS;"
"estimation-cohort-method-covariateBalance.R","632","651","SELECT DISTINCT dmd.cdm_source_abbreviation database_name, cmds.analysis_id, cmds.target_id, cmds.comparator_id, cmds.outcome_id, cmds.max_sdm, cmds.ease FROM @schema.@cm_table_prefixdiagnostics_summary cmds INNER JOIN @schema.@database_table dmd ON dmd.database_id = cmds.database_id  where cmds.target_id = @target_id and cmds.comparator_id = @comparator_id and cmds.outcome_id = @outcome_id and cmds.analysis_id = @analysis_id and cmds.database_id = '@database_id' ;"
"estimation-cohort-method-diagnostics.R","63","94","SELECT DISTINCT dmd.cdm_source_abbreviation database_name, cma.description analysis, cgcd1.cohort_name target, cgcd2.cohort_name comparator, cgcd3.cohort_name outcome, cmds.max_sdm, cmds.shared_max_sdm, cmds.equipoise, cmds.mdrr, cmds.ease, cmds.balance_diagnostic, cmds.shared_balance_diagnostic, -- added back cmds.equipoise_diagnostic, cmds.mdrr_diagnostic, cmds.ease_diagnostic, cmds.unblind FROM @schema.@cm_table_prefixdiagnostics_summary cmds INNER JOIN @schema.@cm_table_prefixanalysis cma ON cmds.analysis_id = cma.analysis_id INNER JOIN @schema.@database_table dmd ON dmd.database_id = cmds.database_id INNER JOIN @schema.@cg_table_prefixcohort_definition cgcd1 ON cmds.target_id = cgcd1.cohort_definition_id INNER JOIN @schema.@cg_table_prefixcohort_definition cgcd2 ON cmds.comparator_id = cgcd2.cohort_definition_id INNER JOIN @schema.@cg_table_prefixcohort_definition cgcd3 ON cmds.outcome_id = cgcd3.cohort_definition_id  where cgcd1.cohort_definition_id in (@targets) {@use_comparators}?{and cgcd2.cohort_definition_id in (@comparators)} and cgcd3.cohort_definition_id in (@outcomes) {@use_analyses}?{and cma.analysis_id in (@analyses)} ;"
"estimation-cohort-method-kaplainMeier.R","144","155","SELECT * FROM @schema.@cm_table_prefixkaplan_meier_dist cmkmd WHERE cmkmd.target_id = @target_id AND cmkmd.comparator_id = @comparator_id AND cmkmd.outcome_id = @outcome_id AND cmkmd.analysis_id = @analysis_id AND cmkmd.database_id = '@database_id';"
"estimation-cohort-method-populationCharacteristics.R","176","202","SELECT cmcb.database_id, cmcb.covariate_id, cmc.covariate_name, cmc.covariate_analysis_id analysis_id, cmcb.target_mean_before before_ps_adjustment_mean_treated, cmcb.comparator_mean_before before_ps_adjustment_mean_comparator, abs(cmcb.std_diff_before) abs_before_ps_adjustment_std_diff, cmcb.target_mean_after after_ps_adjustment_mean_treated, cmcb.comparator_mean_after after_ps_adjustment_mean_comparator, abs(cmcb.std_diff_after) abs_after_ps_adjustment_std_diff FROM (select * from  @schema.@cm_table_prefixcovariate_balance WHERE target_id = @target_id AND comparator_id = @comparator_id AND outcome_id = @outcome_id AND analysis_id = @analysis_id AND database_id = '@database_id' ) as cmcb INNER JOIN @schema.@cm_table_prefixcovariate cmc  ON cmcb.covariate_id = cmc.covariate_id AND cmcb.analysis_id = cmc.analysis_id AND cmcb.database_id = cmc.database_id -- database_id optional"
"estimation-cohort-method-power.R","394","399","SELECT cma.* FROM @schema.@cm_table_prefixanalysis cma"
"estimation-cohort-method-power.R","423","433","SELECT * FROM @schema.@cm_table_prefixfollow_up_dist cmfud WHERE cmfud.target_id = @target_id AND cmfud.comparator_id = @comparator_id AND cmfud.outcome_id = @outcome_id AND cmfud.analysis_id = @analysis_id"
"estimation-cohort-method-propensityModel.R","145","171","SELECT cmc.covariate_id, cmc.covariate_name, cmpm.coefficient FROM ( SELECT covariate_id, covariate_name FROM @schema.@cm_table_prefixcovariate WHERE analysis_id = @analysis_id AND database_id = '@database_id' UNION SELECT 0 as covariate_id, 'intercept' as covariate_name) cmc JOIN @schema.@cm_table_prefixpropensity_model cmpm ON cmc.covariate_id = cmpm.covariate_id WHERE cmpm.target_id = @target_id AND cmpm.comparator_id = @comparator_id AND cmpm.analysis_id = @analysis_id AND cmpm.database_id = '@database_id'"
"estimation-cohort-method-propensityScoreDistribution.R","139","149","SELECT database_id, target_id, comparator_id, outcome_id, analysis_id, equipoise FROM @schema.@cm_table_prefixdiagnostics_summary cmpsd WHERE cmpsd.target_id = @target_id AND cmpsd.comparator_id = @comparator_id AND cmpsd.analysis_id = @analysis_id AND cmpsd.outcome_id = @outcome_id"
"estimation-cohort-method-propensityScoreDistribution.R","187","196","SELECT * FROM @schema.@cm_table_prefixpreference_score_dist cmpsd WHERE cmpsd.target_id = @target_id AND cmpsd.comparator_id = @comparator_id AND cmpsd.analysis_id = @analysis_id"
"estimation-cohort-method-results.R","297","356","SELECT cma.analysis_id, cma.description description, dmd.database_id database_id, dmd.cdm_source_abbreviation cdm_source_abbreviation, cmr.target_id, cg1.cohort_name as target, cmr.outcome_id, cg2.cohort_name as outcome, cmr.comparator_id, cg3.cohort_name as comparator, case when COALESCE(cmds.unblind, 0) = 0 then NULL else cmr.rr end rr, case when COALESCE(cmds.unblind, 0) = 0 then NULL else cmr.ci_95_lb end ci_95_lb, case when COALESCE(cmds.unblind, 0) = 0 then NULL else cmr.ci_95_ub end ci_95_ub, case when COALESCE(cmds.unblind, 0) = 0 then NULL else cmr.p end p, case when COALESCE(cmds.unblind, 0) = 0 then NULL else cmr.log_rr end log_rr, case when COALESCE(cmds.unblind, 0) = 0 then NULL else cmr.se_log_rr end se_log_rr, cmr.target_subjects, cmr.comparator_subjects, cmr.target_days, cmr.comparator_days, cmr.target_outcomes, cmr.comparator_outcomes, case when COALESCE(cmds.unblind, 0) = 0 then NULL else cmr.calibrated_rr end calibrated_rr, case when COALESCE(cmds.unblind, 0) = 0 then NULL else cmr.calibrated_ci_95_lb end calibrated_ci_95_lb, case when COALESCE(cmds.unblind, 0) = 0 then NULL else cmr.calibrated_ci_95_ub end calibrated_ci_95_ub, case when COALESCE(cmds.unblind, 0) = 0 then NULL else cmr.calibrated_p end calibrated_p, case when COALESCE(cmds.unblind, 0) = 0 then NULL else cmr.calibrated_log_rr end calibrated_log_rr, case when COALESCE(cmds.unblind, 0) = 0 then NULL else cmr.calibrated_se_log_rr end calibrated_se_log_rr, COALESCE(cmds.unblind, 0) unblind FROM @schema.@cm_table_prefixanalysis cma JOIN @schema.@cm_table_prefixresult cmr on cmr.analysis_id = cma.analysis_id  JOIN @schema.@database_table dmd on dmd.database_id = cmr.database_id  LEFT JOIN @schema.@cm_table_prefixdiagnostics_summary cmds on cmds.analysis_id = cmr.analysis_id AND cmds.target_id = cmr.target_id AND cmds.comparator_id = cmr.comparator_id AND cmds.outcome_id = cmr.outcome_id AND cmds.database_id = cmr.database_id  inner join @schema.@cg_table_prefixcohort_definition cg1 on cg1.cohort_definition_id = cmr.target_id  inner join @schema.@cg_table_prefixcohort_definition cg2 on cg2.cohort_definition_id = cmr.outcome_id  inner join @schema.@cg_table_prefixcohort_definition cg3 on cg3.cohort_definition_id = cmr.comparator_id  where cmr.target_id in (@targets) {@use_comparators}?{and cmr.comparator_id in (@comparators)} and cmr.outcome_id in (@outcomes) ;"
"estimation-cohort-method-results.R","386","461","select r.analysis_id, a.description, 0 as database_id, ev.evidence_synthesis_description as cdm_source_abbreviation, r.target_id, c1.cohort_name as target, r.outcome_id, c3.cohort_name as outcome, r.comparator_id, c2.cohort_name as comparator, NULL as rr, NULL as ci_95_lb, NULL as ci_95_ub, NULL as p, NULL as log_rr, NULL as se_log_rr, 0 as target_subjects, 0 as comparator_subjects, 0 as target_days, 0 as comparator_days, 0 as target_outcomes, 0 as comparator_outcomes, r.calibrated_rr, r.calibrated_ci_95_lb, r.calibrated_ci_95_ub, r.calibrated_p, r.calibrated_log_rr, r.calibrated_se_log_rr, 1 unblind  from @schema.@es_table_prefixcm_result as r inner join @schema.@cm_table_prefixtarget_comparator_outcome as tco on r.target_id = tco.target_id and r.comparator_id = tco.comparator_id and r.outcome_id = tco.outcome_id  inner join  @schema.@es_table_prefixcm_diagnostics_summary as unblind on r.analysis_id = unblind.analysis_id and r.target_id = unblind.target_id and r.comparator_id = unblind.comparator_id and r.outcome_id = unblind.outcome_id  inner join @schema.@cg_table_prefixcohort_definition as c1 on c1.cohort_definition_id = r.target_id  inner join @schema.@cg_table_prefixcohort_definition as c2 on c2.cohort_definition_id = r.comparator_id  inner join @schema.@cg_table_prefixcohort_definition as c3 on c3.cohort_definition_id = r.outcome_id  inner join @schema.@cm_table_prefixanalysis as a on a.analysis_id = r.analysis_id  inner join @schema.@es_table_prefixanalysis as ev on ev.evidence_synthesis_analysis_id = r.evidence_synthesis_analysis_id  where r.calibrated_rr != 0 and tco.outcome_of_interest = 1 and unblind.unblind = 1 and r.target_id in (@target_ids) and r.outcome_id = @outcome_id   ;"
"estimation-cohort-method-systematicError.R","161","174","SELECT cmr.*, cmtco.true_effect_size effect_size FROM @schema.@cm_table_prefixresult cmr JOIN @schema.@cm_table_prefixtarget_comparator_outcome cmtco ON cmr.target_id = cmtco.target_id AND cmr.comparator_id = cmtco.comparator_id AND cmr.outcome_id = cmtco.outcome_id WHERE cmtco.outcome_of_interest != 1 AND cmr.target_id = @target_id AND cmr.comparator_id = @comparator_id AND cmr.analysis_id = @analysis_id"
"estimation-cohort-method-systematicError.R","321","338","SELECT DISTINCT dmd.cdm_source_abbreviation database_name, cmds.analysis_id, cmds.target_id, cmds.comparator_id, cmds.max_sdm, cmds.ease FROM @schema.@cm_table_prefixdiagnostics_summary cmds INNER JOIN @schema.@database_table dmd ON dmd.database_id = cmds.database_id  where cmds.target_id = @target_id and cmds.comparator_id = @comparator_id and cmds.analysis_id = @analysis_id and cmds.database_id = '@database_id' ;"
"estimation-sccs-diagnostics.R","57","102","SELECT d.cdm_source_abbreviation as database_name, a.description as analysis, c2.cohort_name as target, c3.cohort_name as indication, c.cohort_name as outcome, cov.covariate_name, ds.* FROM @schema.@sccs_table_prefixdiagnostics_summary ds inner join @schema.@sccs_table_prefixexposures_outcome_set eos on ds.exposures_outcome_set_id = eos.exposures_outcome_set_id inner join @schema.@cg_table_prefixcohort_definition as c on c.cohort_definition_id = eos.outcome_id  INNER JOIN @schema.@database_table_prefix@database_table d on d.database_id = ds.database_id  INNER JOIN @schema.@sccs_table_prefixanalysis a on a.analysis_id = ds.analysis_id  INNER JOIN @schema.@sccs_table_prefixcovariate cov on cov.covariate_id = ds.covariate_id and cov.exposures_outcome_set_id = ds.exposures_outcome_set_id and cov.analysis_id = ds.analysis_id and cov.database_id = ds.database_id  inner join @schema.@cg_table_prefixcohort_definition as c2 on cov.era_id = c2.cohort_definition_id  left join @schema.@cg_table_prefixcohort_definition as c3 on eos.nesting_cohort_id = c3.cohort_definition_id  where  cov.era_id in (@target_ids) and eos.outcome_id in (@outcome_ids) ;"
"estimation-sccs-results-full.R","459","467","SELECT * FROM @schema.@sccs_table_prefixattrition  WHERE database_id = '@database_id' AND analysis_id = @analysis_id AND exposures_outcome_set_id = @exposures_outcome_set_id AND covariate_id = @covariate_id"
"estimation-sccs-results-full.R","489","517","SELECT CASE WHEN era.era_name IS NULL THEN sc.covariate_name ELSE CONCAT(sc.covariate_name, ' : ', era.era_name) END as covariate_name, scr.covariate_id, scr.rr, scr.ci_95_lb, scr.ci_95_ub FROM @schema.@sccs_table_prefixcovariate_result scr INNER JOIN @schema.@sccs_table_prefixcovariate sc ON ( sc.exposures_outcome_set_id = scr.exposures_outcome_set_id AND sc.database_id = scr.database_id AND sc.analysis_id = scr.analysis_id AND sc.covariate_id = scr.covariate_id ) LEFT JOIN @schema.@cg_table_prefixcohort_definition cd ON cd.cohort_definition_id = sc.era_id LEFT JOIN @schema.@sccs_table_prefixera era ON ( era.exposures_outcome_set_id = scr.exposures_outcome_set_id AND era.database_id = scr.database_id AND era.analysis_id = scr.analysis_id AND era.era_id = sc.era_id )  WHERE scr.database_id = '@database_id' AND scr.analysis_id = @analysis_id --AND  sc.era_id = @exposure_id --AND scr.rr IS NOT NULL AND scr.exposures_outcome_set_id = @exposures_outcome_set_id"
"estimation-sccs-results-full.R","539","545","SELECT * FROM @schema.@sccs_table_prefixtime_trend WHERE database_id = '@database_id' AND analysis_id = @analysis_id AND exposures_outcome_set_id = @exposures_outcome_set_id"
"estimation-sccs-results-full.R","567","575","SELECT pre_exposure_p FROM @schema.@sccs_table_prefixdiagnostics_summary  WHERE database_id = '@database_id' AND covariate_id  = @covariate_id AND analysis_id = @analysis_id AND exposures_outcome_set_id = @exposures_outcome_set_id"
"estimation-sccs-results-full.R","593","601","SELECT * , @p as p FROM @schema.@sccs_table_prefixtime_to_event  WHERE database_id = '@database_id' AND era_id  = @exposure_id AND analysis_id = @analysis_id AND exposures_outcome_set_id = @exposures_outcome_set_id;"
"estimation-sccs-results-full.R","627","634","SELECT * FROM @schema.@sccs_table_prefixevent_dep_observation  WHERE database_id = '@database_id' AND analysis_id = @analysis_id AND exposures_outcome_set_id = @exposures_outcome_set_id;"
"estimation-sccs-results-full.R","654","661","SELECT * FROM @schema.@sccs_table_prefixage_spanning  WHERE database_id = '@database_id' AND analysis_id = @analysis_id AND exposures_outcome_set_id = @exposures_outcome_set_id"
"estimation-sccs-results-full.R","680","687","SELECT * FROM @schema.@sccs_table_prefixcalendar_time_spanning  WHERE database_id = '@database_id' AND analysis_id = @analysis_id AND exposures_outcome_set_id = @exposures_outcome_set_id"
"estimation-sccs-results-full.R","708","716","SELECT * FROM @schema.@sccs_table_prefixspline  WHERE database_id = '@database_id' AND analysis_id = @analysis_id AND exposures_outcome_set_id = @exposures_outcome_set_id AND spline_type = '@spline_type';"
"estimation-sccs-results-full.R","740","766","SELECT r.ci_95_lb, r.ci_95_ub, r.log_rr, r.se_log_rr, r.calibrated_ci_95_lb, r.calibrated_ci_95_ub, r.calibrated_log_rr, r.calibrated_se_log_rr, r.exposures_outcome_set_id, e.true_effect_size, c.exposures_outcome_set_id  FROM @schema.@sccs_table_prefixresult r INNER JOIN @schema.@sccs_table_prefixexposure e on r.exposures_outcome_set_id = e.exposures_outcome_set_id  INNER JOIN @schema.@sccs_table_prefixcovariate c on e.era_id = c.era_id and e.exposures_outcome_set_id = c.exposures_outcome_set_id and c.database_id = r.database_id and c.analysis_id = r.analysis_id and c.covariate_id = r.covariate_id  WHERE r.database_id = '@database_id' AND r.analysis_id = @analysis_id AND r.covariate_id = @covariate_id AND e.true_effect_size is not NULL -- AND e.era_id = @era_id ;"
"estimation-sccs-results-full.R","780","784","SELECT top 1 ds.easeFROM @schema.@sccs_table_prefixdiagnostics_summary ds WHERE ds.database_id = '@database_id' AND ds.analysis_id = @analysis_id   AND ds.covariate_id = @covariate_id;"
"estimation-sccs-results.R","250","344","SELECT  ds.cdm_source_abbreviation as database_name, sr.database_id, sc.covariate_id, sc.covariate_name, sc.era_id, sc.covariate_analysis_id, sr.analysis_id, a.description, eos.outcome_id, cg1.cohort_name as outcome, cg2.cohort_name as target, cg3.cohort_name as indication, eos.nesting_cohort_id as indication_id, eos.exposures_outcome_set_id,  sr.outcome_subjects, sr.outcome_events, sr.outcome_observation_periods, sr.covariate_subjects, sr.covariate_days, sr.covariate_eras, sr.covariate_outcomes, sr.observed_days,  case when COALESCE(sds.unblind, 0) = 0 then NULL else sr.rr end rr, case when COALESCE(sds.unblind, 0) = 0 then NULL else sr.ci_95_lb end ci_95_lb, case when COALESCE(sds.unblind, 0) = 0 then NULL else sr.ci_95_ub end ci_95_ub, case when COALESCE(sds.unblind, 0) = 0 then NULL else sr.p end p, case when COALESCE(sds.unblind, 0) = 0 then NULL else sr.log_rr end log_rr, case when COALESCE(sds.unblind, 0) = 0 then NULL else sr.se_log_rr end se_log_rr, case when COALESCE(sds.unblind, 0) = 0 then NULL else sr.calibrated_rr end calibrated_rr, case when COALESCE(sds.unblind, 0) = 0 then NULL else sr.calibrated_ci_95_lb end calibrated_ci_95_lb, case when COALESCE(sds.unblind, 0) = 0 then NULL else sr.calibrated_ci_95_ub end calibrated_ci_95_ub, case when COALESCE(sds.unblind, 0) = 0 then NULL else sr.calibrated_p end calibrated_p, case when COALESCE(sds.unblind, 0) = 0 then NULL else sr.calibrated_log_rr end calibrated_log_rr, case when COALESCE(sds.unblind, 0) = 0 then NULL else sr.calibrated_se_log_rr end calibrated_se_log_rr,  case when COALESCE(sds.unblind, 0) = 0 then NULL else sr.llr end llr,   sds.mdrr, --sds.ease, --sds.time_trend_p, --sds.pre_exposure_p, --sds.mdrr_diagnostic, --sds.ease_diagnostic, --sds.time_trend_diagnostic, --sds.pre_exposure_diagnostic, sds.unblind  FROM @schema.@sccs_table_prefixresult sr INNER JOIN @schema.@database_table_prefix@database_table ds ON sr.database_id = ds.database_id INNER JOIN @schema.@sccs_table_prefixdiagnostics_summary sds ON ( sds.exposures_outcome_set_id = sr.exposures_outcome_set_id AND sds.database_id = sr.database_id AND sds.analysis_id = sr.analysis_id AND sds.covariate_id = sr.covariate_id ) INNER JOIN @schema.@sccs_table_prefixcovariate sc ON ( sc.exposures_outcome_set_id = sr.exposures_outcome_set_id AND sc.database_id = sr.database_id AND sc.analysis_id = sr.analysis_id AND sc.covariate_id = sr.covariate_id ) INNER JOIN @schema.@sccs_table_prefixexposures_outcome_set eos ON eos.exposures_outcome_set_id = sr.exposures_outcome_set_id INNER JOIN @schema.@sccs_table_prefixanalysis a on a.analysis_id = sr.analysis_id  inner join @schema.@cg_table_prefixcohort_definition cg1 on cg1.cohort_definition_id = eos.outcome_id  inner join @schema.@cg_table_prefixcohort_definition as cg2 on cg2.cohort_definition_id = sc.era_id  left join @schema.@cg_table_prefixcohort_definition as cg3 on eos.nesting_cohort_id = cg3.cohort_definition_id  WHERE eos.outcome_id IN (@outcome_ids) AND sc.era_id IN (@exposure_ids) ;"
"estimation-sccs-results.R","372","459","select distinctev.evidence_synthesis_description as database_name, 0 as database_id, cov.covariate_id, -- exists? cov.covariate_name, cov.era_id, 0 as covariate_analysis_id, esr.analysis_id, a.description, eos.outcome_id, c3.cohort_name as outcome, c1.cohort_name as target, c4.cohort_name as indication, eos.nesting_cohort_id as indication_id, eos.exposures_outcome_set_id, esr.outcome_subjects, esr.outcome_events, esr.outcome_observation_periods, esr.covariate_subjects, esr.covariate_days, esr.covariate_eras, esr.covariate_outcomes, esr.observed_days, esr.rr, esr.ci_95_lb, esr.ci_95_ub, esr.p, esr.log_rr, esr.se_log_rr, esr.calibrated_rr, esr.calibrated_ci_95_lb, esr.calibrated_ci_95_ub, esr.calibrated_p, esr.calibrated_log_rr, esr.calibrated_se_log_rr, NULL as llr, esd.mdrr, esd.unblind as unblind  from @schema.@es_table_prefixsccs_result as esr inner join @schema.@sccs_table_prefixexposures_outcome_set as eos on esr.exposures_outcome_set_id = eos.exposures_outcome_set_id  inner join @schema.@sccs_table_prefixcovariate as cov on esr.covariate_id = cov.covariate_id and esr.analysis_id = cov.analysis_id and esr.exposures_outcome_set_id = cov.exposures_outcome_set_id  inner join  @schema.@es_table_prefixsccs_diagnostics_summary as esd on esr.analysis_id = esd.analysis_id and esr.exposures_outcome_set_id = esd.exposures_outcome_set_id and esr.covariate_id = esd.covariate_id and esr.evidence_synthesis_analysis_id = esd.evidence_synthesis_analysis_id  inner join @schema.@cg_table_prefixcohort_definition as c1 on c1.cohort_definition_id = cov.era_id  inner join @schema.@cg_table_prefixcohort_definition as c3 on c3.cohort_definition_id = eos.outcome_id  inner join @schema.@sccs_table_prefixanalysis as a on a.analysis_id = esr.analysis_id  inner join @schema.@es_table_prefixanalysis as ev on ev.evidence_synthesis_analysis_id = esr.evidence_synthesis_analysis_id  left join @schema.@cg_table_prefixcohort_definition as c4 on eos.nesting_cohort_id = c4.cohort_definition_id  where esr.calibrated_rr != 0 and esd.unblind = 1 and cov.era_id in (@target_ids) and eos.outcome_id in (@outcome_id)   ;"
"helpers-getPredictionResult.R","15","15","SELECT * FROM @schema.@table_name WHERE performance_id = @performance_id"
"helpers-sccsDataPulls.R","6","22","select distinct c.cohort_name as name, eos.outcome_id  from @schema.@sccs_table_prefixexposures_outcome_set as eos inner join @schema.@cg_table_prefixcohort_definition as c on c.cohort_definition_id = eos.outcome_id inner join @schema.@sccs_table_prefixexposure as e on e.exposures_outcome_set_id = eos.exposures_outcome_set_id  --where e.true_effect_size != 1 ;"
"helpers-sccsDataPulls.R","41","59","SELECTe.era_id AS exposure_id, c2.cohort_name as exposure_name, coalesce(c.cohort_definition_id, -1) as indication_id, coalesce(c.cohort_name, 'No indication') as indication_name  FROM @schema.@sccs_table_prefixexposures_outcome_set eos LEFT JOIN @schema.@cg_table_prefixcohort_definition c on eos.nesting_cohort_id = c.cohort_definition_id  INNER JOIN @schema.@sccs_table_prefixcovariate cov ON eos.exposures_outcome_set_id = cov.exposures_outcome_set_id  INNER JOIN @schema.@sccs_table_prefixexposure e ON eos.exposures_outcome_set_id = e.exposures_outcome_set_id AND cov.era_id = e.era_id  INNER JOIN @schema.@cg_table_prefixcohort_definition c2 on e.era_id = c2.cohort_definition_id GROUP BY c.cohort_definition_id,  c.cohort_name, e.era_id, c2.cohort_name"
"helpers-sccsDataPulls.R","77","99","select distinct c1.cohort_name as name, e.era_id as exposure_id  from @schema.@sccs_table_prefixresult r  INNER JOIN @schema.@sccs_table_prefixexposures_outcome_set eos ON r.exposures_outcome_set_id = eos.exposures_outcome_set_id  INNER JOIN @schema.@sccs_table_prefixcovariate cov ON r.exposures_outcome_set_id = cov.exposures_outcome_set_id AND r.analysis_id = cov.analysis_id AND r.covariate_id = cov.covariate_id  INNER JOIN @schema.@sccs_table_prefixexposure e ON r.exposures_outcome_set_id = e.exposures_outcome_set_id AND cov.era_id = e.era_id  INNER JOIN @schema.@cg_table_prefixcohort_definition as c1 on c1.cohort_definition_id = e.era_id WHERE e.true_effect_size IS NULL ;"
"helpers-sccsDataPulls.R","119","129","select distinct ds.cdm_source_abbreviation as database_name, r.database_id  from @schema.@database_table_prefix@database_table ds inner join @schema.@sccs_table_prefixresult as r on r.database_id = ds.database_id;"
"helpers-sccsDataPulls.R","150","161","select distinct a.description as name, r.analysis_id  from @schema.@sccs_table_prefixresult as r inner join @schema.@sccs_table_prefixanalysis as a on r.analysis_id = a.analysis_id ;"
"helpers-sccsDataPulls.R","186","217","SELECT CASE WHEN era.era_name IS NULL THEN sc.covariate_name ELSE CONCAT(sc.covariate_name, ' : ', era.era_name) END as covariate_name, scr.covariate_id, scr.rr, scr.ci_95_lb, scr.ci_95_ub FROM @schema.@sccs_table_prefixcovariate_result scr INNER JOIN @schema.@sccs_table_prefixcovariate sc ON ( sc.exposures_outcome_set_id = scr.exposures_outcome_set_id AND sc.database_id = scr.database_id AND sc.analysis_id = scr.analysis_id AND sc.covariate_id = scr.covariate_id ) LEFT JOIN @schema.@cg_table_prefixcohort_definition cd ON cd.cohort_definition_id = sc.era_id LEFT JOIN @schema.@sccs_table_prefixera era ON ( era.exposures_outcome_set_id = scr.exposures_outcome_set_id AND era.database_id = scr.database_id AND era.analysis_id = scr.analysis_id AND era.era_id = sc.era_id ) INNER JOIN @schema.@sccs_table_prefixexposures_outcome_set eos ON eos.exposures_outcome_set_id = scr.exposures_outcome_set_id  WHERE scr.database_id = '@database_id' AND scr.analysis_id = @analysis_id AND eos.outcome_id = @outcome_id AND  sc.era_id = @exposure_id AND scr.rr IS NOT NULL"
"helpers-sccsDataPulls.R","236","245","SELECT tt.* FROM @schema.@sccs_table_prefixtime_trend tt inner join @schema.@sccs_table_prefixexposures_outcome_set eos on tt.exposures_outcome_set_id = eos.exposures_outcome_set_id WHERE database_id = '@database_id' AND analysis_id = @analysis_id AND outcome_id = @outcome_id"
"helpers-sccsDataPulls.R","265","275","SELECT ds.pre_exposure_p FROM @schema.@sccs_table_prefixdiagnostics_summary ds inner join @schema.@sccs_table_prefixexposures_outcome_set eos on ds.exposures_outcome_set_id = eos.exposures_outcome_set_id WHERE ds.database_id = '@database_id' AND ds.covariate_id  = @covariate_id AND ds.analysis_id = @analysis_id AND eos.outcome_id = @outcome_id"
"helpers-sccsDataPulls.R","288","298","SELECT tte.*, @p as p FROM @schema.@sccs_table_prefixtime_to_event tte inner join @schema.@sccs_table_prefixexposures_outcome_set eos on tte.exposures_outcome_set_id = eos.exposures_outcome_set_id WHERE tte.database_id = '@database_id' AND tte.era_id  = @exposure_id AND tte.analysis_id = @analysis_id AND eos.outcome_id = @outcome_id"
"helpers-sccsDataPulls.R","324","335","SELECT a.* FROM @schema.@sccs_table_prefixattrition a inner join @schema.@sccs_table_prefixexposures_outcome_set eos on a.exposures_outcome_set_id = eos.exposures_outcome_set_id  WHERE a.database_id = '@database_id' AND a.analysis_id = @analysis_id AND eos.outcome_id = @outcome_id AND a.covariate_id = @covariate_id"
"helpers-sccsDataPulls.R","351","361","SELECT o.* FROM @schema.@sccs_table_prefixevent_dep_observation o inner join @schema.@sccs_table_prefixexposures_outcome_set eos on o.exposures_outcome_set_id = eos.exposures_outcome_set_id  WHERE o.database_id = '@database_id' AND o.analysis_id = @analysis_id AND eos.outcome_id = @outcome_id"
"helpers-sccsDataPulls.R","376","386","SELECT asp.* FROM @schema.@sccs_table_prefixage_spanning asp inner join @schema.@sccs_table_prefixexposures_outcome_set eos on asp.exposures_outcome_set_id = eos.exposures_outcome_set_id  WHERE asp.database_id = '@database_id' AND asp.analysis_id = @analysis_id AND eos.outcome_id = @outcome_id"
"helpers-sccsDataPulls.R","401","411","SELECT ts.* FROM @schema.@sccs_table_prefixcalendar_time_spanning ts inner join @schema.@sccs_table_prefixexposures_outcome_set eos on ts.exposures_outcome_set_id = eos.exposures_outcome_set_id  WHERE ts.database_id = '@database_id' AND ts.analysis_id = @analysis_id AND eos.outcome_id = @outcome_id"
"helpers-sccsDataPulls.R","428","439","SELECT s.* FROM @schema.@sccs_table_prefixspline s inner join @schema.@sccs_table_prefixexposures_outcome_set eos on s.exposures_outcome_set_id = eos.exposures_outcome_set_id  WHERE s.database_id = '@database_id' AND s.analysis_id = @analysis_id AND eos.outcome_id = @outcome_id AND s.spline_type = '@spline_type';"
"helpers-sccsDataPulls.R","457","474","SELECT ci_95_lb, ci_95_ub, log_rr, se_log_rr, calibrated_ci_95_lb, calibrated_ci_95_ub, calibrated_log_rr, calibrated_se_log_rr, true_effect_size FROM @schema.@sccs_table_prefixresult sr INNER JOIN @schema.@sccs_table_prefixcovariate sc ON ( sc.exposures_outcome_set_id = sr.exposures_outcome_set_id AND sc.database_id = sr.database_id AND sc.analysis_id = sr.analysis_id AND sc.covariate_id = sr.covariate_id ) INNER JOIN @schema.@sccs_table_prefixexposure se ON ( se.exposures_outcome_set_id = sr.exposures_outcome_set_id AND se.era_id = sc.era_id ) WHERE sr.database_id = '@database_id' AND sr.analysis_id = @analysis_id AND sr.covariate_id = @covariate_id"
"helpers-sccsDataPulls.R","491","510","SELECT ds.* FROM @schema.@sccs_table_prefixdiagnostics_summary ds inner join @schema.@sccs_table_prefixexposures_outcome_set eos on ds.exposures_outcome_set_id = eos.exposures_outcome_set_id  inner join @schema.@sccs_table_prefixcovariate cov on cov.covariate_id = ds.covariate_id and cov.exposures_outcome_set_id = ds.exposures_outcome_set_id and cov.analysis_id = ds.analysis_id and cov.database_id = ds.database_id  WHERE ds.database_id = '@database_id' AND ds.analysis_id = @analysis_id AND ds.covariate_id = @covariate_id AND eos.outcome_id = @outcome_id AND cov.era_id = @exposure_id"
"patient-level-prediction-covariateSummary.R","286","287","SELECT train_details FROM @schema.@plp_table_prefixmodels WHERE database_id = @database_id       and model_design_id = @model_design_id;"
"patient-level-prediction-covariateSummary.R","444","444","SELECT * FROM @schema.@plp_table_prefixcovariate_summary WHERE performance_id = @performance_id;"
"patient-level-prediction-covariateSummary.R","477","478","SELECT intercept FROM @schema.@plp_table_prefixmodels WHERE database_id = @database_id       and model_design_id = @model_design_id"
"patient-level-prediction-designSummary.R","271","281","SELECT distinct cohorts.cohort_id, cohorts.cohort_name FROM @schema.@plp_table_prefixmodel_designs as model_designs inner join (SELECT c.cohort_id, cd.cohort_name FROM @schema.@plp_table_prefixcohorts c inner join @schema.@cg_table_prefixcohort_definition cd on c.cohort_definition_id = cd.cohort_definition_id ) AS cohorts ON model_designs.@type_id = cohorts.cohort_id         ;"
"patient-level-prediction-designSummary.R","310","368","SELECT model_designs.model_design_id, model_settings.model_type AS model_type, targets.cohort_name AS target, outcomes.cohort_name AS outcome, tars.tar_start_day, tars.tar_start_anchor, tars.tar_end_day, tars.tar_end_anchor, COUNT(distinct diag.database_id) as diag_databases, COUNT(distinct d.database_id) dev_databases, MIN(p.value) min_AUROC, AVG(p.value) mean_AUROC, MAX(p.value) max_AUROC, COUNT(distinct v.database_id) val_databases  FROM @schema.@plp_table_prefixmodel_designs as model_designs inner join @schema.@plp_table_prefixmodel_settings as model_settings on model_designs.model_setting_id = model_settings.model_setting_id  LEFT JOIN @schema.@plp_table_prefixperformances AS results  on model_designs.model_design_id = results.model_design_id  LEFT JOIN (select * from @schema.@plp_table_prefixEVALUATION_STATISTICS where EVALUATION = 'Test' and METRIC = 'AUROC') p on p.performance_id = results.performance_id  LEFT JOIN (SELECT c.cohort_id, cd.cohort_name FROM @schema.@plp_table_prefixcohorts c inner join @schema.@cg_table_prefixcohort_definition cd on c.cohort_definition_id = cd.cohort_definition_id ) AS targets ON model_designs.target_id = targets.cohort_id LEFT JOIN (SELECT c.cohort_id, cd.cohort_name FROM @schema.@plp_table_prefixcohorts c inner join @schema.@cg_table_prefixcohort_definition cd on c.cohort_definition_id = cd.cohort_definition_id ) AS outcomes ON model_designs.outcome_id = outcomes.cohort_id LEFT JOIN @schema.@plp_table_prefixtars AS tars ON model_designs.tar_id = tars.tar_id  LEFT JOIN @schema.@plp_table_prefixdatabase_details AS d ON results.development_database_id = d.database_id LEFT JOIN @schema.@plp_table_prefixdatabase_details AS v ON results.validation_database_id = v.database_id  LEFT JOIN @schema.@plp_table_prefixdiagnostics AS diag ON results.development_database_id = diag.database_id  WHERE targets.cohort_id in (@target_ids) AND outcomes.cohort_id in (@outcome_ids)  GROUP BY model_designs.model_design_id, model_settings.model_type, targets.cohort_name, outcomes.cohort_name, tars.tar_start_day, tars.tar_start_anchor,           tars.tar_end_day, tars.tar_end_anchor;"
"patient-level-prediction-diagnostics.R","428","460","SELECT distinct design.MODEL_DESIGN_ID,diagnostics.diagnostic_id, database.DATABASE_NAME, cohortT.COHORT_NAME target_name, cohortO.COHORT_NAME outcome_name, summary.PROBAST_ID, summary.RESULT_VALUE  from (select * from @schema.@plp_table_prefixDIAGNOSTICS where MODEL_DESIGN_ID = @model_design_id) as diagnostics inner join @schema.@plp_table_prefixMODEL_DESIGNS design on diagnostics.MODEL_DESIGN_ID = design.MODEL_DESIGN_ID  inner join @schema.@plp_table_prefixDIAGNOSTIC_SUMMARY summary on diagnostics.DIAGNOSTIC_ID = summary.DIAGNOSTIC_ID  inner join (select dd.database_id, md.cdm_source_abbreviation as database_name from @schema.@database_table_prefixdatabase_meta_data md inner join @schema.@plp_table_prefixdatabase_details dd on md.database_id = dd.database_meta_data_id) as database on database.database_id = diagnostics.database_id  inner join @schema.@plp_table_prefixCOHORTS cohortT on cohortT.cohort_id = design.target_id  inner join @schema.@plp_table_prefixCOHORTS cohortO on cohortO.cohort_id = design.outcome_id;"
"patient-level-prediction-diagnostics.R","505","505","SELECT * FROM @schema.@plp_table_prefix@table_name WHERE diagnostic_id = @diagnostic_id;"
"patient-level-prediction-diagnostics.R","538","538","SELECT * FROM @schema.@plp_table_prefix@table_name WHERE diagnostic_id = @diagnostic_id;"
"patient-level-prediction-diagnostics.R","557","557","SELECT * FROM @schema.@plp_table_prefix@table_name WHERE diagnostic_id = @diagnostic_id;"
"patient-level-prediction-modelSummary.R","224","224","SELECT * FROM @schema.@plp_table_prefixattrition WHERE performance_id = @performance_id;"
"patient-level-prediction-modelSummary.R","253","303","SELECT distinct results.performance_id, results.model_design_id, results.development_database_id, results.validation_database_id, d.database_acronym AS Dev, v.database_acronym AS Val, targets.cohort_name AS T, outcomes.cohort_name AS O, results.execution_date_time as time_stamp, tars.tar_start_day, tars.tar_start_anchor, tars.tar_end_day, tars.tar_end_anchor, ROUND(aucResult.auc, 3) as auroc, ROUND(auprcResult.auprc,4) as auprc, nResult.population_size, oResult.outcome_count, ROUND(nTest.test_size*100.0/nResult.population_size, 1) as eval_percent, ROUND(oResult.outcome_count*100.0/nResult.population_size,4) as outcome_percent, results.model_development  FROM (select * from @schema.@plp_table_prefixperformances where model_design_id = @model_design_id) AS results  inner join @schema.@plp_table_prefixmodel_designs as model_designs on model_designs.model_design_id = results.model_design_id  LEFT JOIN (SELECT c.cohort_id, cd.cohort_name FROM @schema.@plp_table_prefixcohorts c inner join @schema.@cg_table_prefixcohort_definition cd on c.cohort_definition_id = cd.cohort_definition_id ) AS targets ON results.target_id = targets.cohort_id LEFT JOIN (SELECT c.cohort_id, cd.cohort_name FROM @schema.@plp_table_prefixcohorts c inner join @schema.@cg_table_prefixcohort_definition cd on c.cohort_definition_id = cd.cohort_definition_id ) AS outcomes ON results.outcome_id = outcomes.cohort_id LEFT JOIN (select dd.database_id, md.cdm_source_abbreviation database_acronym from @schema.@database_table_prefix@database_table md inner join @schema.@plp_table_prefixdatabase_details dd on md.database_id = dd.database_meta_data_id) AS d ON results.development_database_id = d.database_id LEFT JOIN (select dd.database_id, md.cdm_source_abbreviation database_acronym from @schema.@database_table_prefix@database_table md inner join @schema.@plp_table_prefixdatabase_details dd on md.database_id = dd.database_meta_data_id) AS v ON results.validation_database_id = v.database_id LEFT JOIN @schema.@plp_table_prefixtars AS tars ON results.tar_id = tars.tar_id LEFT JOIN (SELECT performance_id, value AS auc FROM @schema.@plp_table_prefixevaluation_statistics where metric = 'AUROC' and evaluation in ('Test','Validation') ) AS aucResult ON results.performance_id = aucResult.performance_id LEFT JOIN (SELECT performance_id, value AS auprc FROM @schema.@plp_table_prefixevaluation_statistics where metric = 'AUPRC' and evaluation in ('Test','Validation') ) AS auprcResult ON results.performance_id = auprcResult.performance_id LEFT JOIN (SELECT performance_id, sum(value) AS population_size FROM @schema.@plp_table_prefixevaluation_statistics where metric = 'populationSize' and evaluation in ('Train','Test','Validation') group by performance_id) AS nResult ON results.performance_id = nResult.performance_id LEFT JOIN (SELECT performance_id, sum(value) AS outcome_count FROM @schema.@plp_table_prefixevaluation_statistics where metric = 'outcomeCount' and evaluation in ('Train','Test','Validation') group by performance_id) AS oResult ON results.performance_id = oResult.performance_id         LEFT JOIN (SELECT performance_id, value AS test_size FROM @schema.@plp_table_prefixevaluation_statistics where metric = 'populationSize' and evaluation in ('Test', 'Validation') ) AS nTest ON results.performance_id = nTest.performance_id;"
"patient-level-prediction-settings.R","350","380","SELECT tempD.dev_db, tempV.val_db  FROM  (select * from @schema.@plp_table_prefixperformances WHERE performance_id = @performance_id) perf  inner join  (select dd.database_id, dmd.cdm_source_name as dev_db from @schema.@plp_table_prefixdatabase_details as dd inner join @schema.@database_table_prefixdatabase_meta_data as dmd on dd.database_meta_data_id = dmd.database_id) tempD  on tempD.database_id = perf.development_database_id  inner join  (select dd.database_id, dmd.cdm_source_name as val_db from @schema.@plp_table_prefixdatabase_details as dd inner join @schema.@database_table_prefixdatabase_meta_data dmd on dd.database_meta_data_id = dmd.database_id) tempV  on tempV.database_id = perf.validation_database_id     ;"
"patient-level-prediction-settings.R","412","414","SELECT * FROM @schema.@plp_table_prefixmodel_designs     WHERE model_design_id = @model_design_id;"
"patient-level-prediction-settings.R","437","437","SELECT * FROM @schema.@plp_table_prefixmodel_settings WHERE model_setting_id = @model_setting_id;"
"patient-level-prediction-settings.R","452","452","SELECT * FROM @schema.@plp_table_prefixcovariate_settings WHERE covariate_setting_id = @setting_id;"
"patient-level-prediction-settings.R","467","467","SELECT * FROM @schema.@plp_table_prefixpopulation_settings WHERE population_setting_id = @setting_id;"
"patient-level-prediction-settings.R","482","482","SELECT * FROM @schema.@plp_table_prefixfeature_engineering_settings WHERE feature_engineering_setting_id = @setting_id;"
"patient-level-prediction-settings.R","494","494","SELECT * FROM @schema.@plp_table_prefixtidy_covariates_settings WHERE tidy_covariates_setting_id = @setting_id;"
"patient-level-prediction-settings.R","507","507","SELECT * FROM @schema.@plp_table_prefixplp_data_settings WHERE plp_data_setting_id = @setting_id;"
"patient-level-prediction-settings.R","520","520","SELECT * FROM @schema.@plp_table_prefixsample_settings WHERE sample_setting_id = @setting_id;"
"patient-level-prediction-settings.R","533","533","SELECT * FROM @schema.@plp_table_prefixsplit_settings WHERE split_setting_id = @setting_id;"
"patient-level-prediction-settings.R","546","550","SELECT c.*, cd.json as cohort_jsonFROM @schema.@plp_table_prefixcohorts c inner join @schema.@cg_table_prefixcohort_definition cd on c.cohort_definition_id = cd.cohort_definition_id     WHERE c.cohort_id = @setting_id;"
"patient-level-prediction-settings.R","564","568","SELECT c.*, cd.json as cohort_jsonFROM @schema.@plp_table_prefixcohorts c inner join @schema.@cg_table_prefixcohort_definition cd on c.cohort_definition_id = cd.cohort_definition_id     WHERE c.cohort_id = @setting_id;"
"patient-level-prediction-validation.R","256","311","SELECT results.performance_id, results.model_design_id, --databases.database_acronym AS Dev, d.database_acronym AS Val, targets.cohort_name AS target, outcomes.cohort_name AS outcome, results.population_setting_id, -- pop and plp_data settings? tars.tar_start_day, tars.tar_start_anchor, tars.tar_end_day, tars.tar_end_anchor, ROUND(aucResult.auc, 3) as auroc, ROUND(auclbResult.auclb, 3) as auroclb, ROUND(aucubResult.aucub, 3) as aurocub, ROUND(auprcResult.auprc,4) as auprc, nResult.population_size, oResult.outcome_count, ROUND(nTest.test_size*100.0/nResult.population_size, 1) as eval_percent, ROUND(oResult.outcome_count*100.0/nResult.population_size,4) as outcome_percent, ROUND(calibration_in_large, 3) as calibration_in_large  FROM  (SELECT * FROM @schema.@plp_table_appendperformances where model_design_id = @model_design_id and development_database_id = @development_database_id ) AS results  LEFT JOIN (SELECT a.cohort_id, b.cohort_name FROM @schema.@plp_table_appendcohorts as a inner join @schema.@cg_table_appendcohort_definition as b on a.cohort_definition_id = b.cohort_definition_id) AS targets ON results.target_id = targets.cohort_id LEFT JOIN (SELECT a.cohort_id, b.cohort_name FROM @schema.@plp_table_appendcohorts as a inner join @schema.@cg_table_appendcohort_definition as b on a.cohort_definition_id = b.cohort_definition_id ) AS outcomes ON results.outcome_id = outcomes.cohort_id LEFT JOIN (select dd.database_id, md.cdm_source_abbreviation database_acronym from @schema.@database_table_appenddatabase_meta_data md inner join @schema.@plp_table_appenddatabase_details dd on md.database_id = dd.database_meta_data_id) AS d ON results.validation_database_id = d.database_id LEFT JOIN @schema.@plp_table_appendtars AS tars ON results.tar_id = tars.tar_id LEFT JOIN (SELECT performance_id, value AS auc FROM @schema.@plp_table_appendevaluation_statistics where metric = 'AUROC' and evaluation in ('Test','Validation') ) AS aucResult ON results.performance_id = aucResult.performance_id LEFT JOIN (SELECT performance_id, value AS auclb FROM @schema.@plp_table_appendevaluation_statistics where metric = '95% lower AUROC' and evaluation in ('Test','Validation') ) AS auclbResult ON results.performance_id = auclbResult.performance_id LEFT JOIN (SELECT performance_id, value AS aucub FROM @schema.@plp_table_appendevaluation_statistics where metric = '95% upper AUROC' and evaluation in ('Test','Validation') ) AS aucubResult ON results.performance_id = aucubResult.performance_id LEFT JOIN (SELECT performance_id, value AS auprc FROM @schema.@plp_table_appendevaluation_statistics where metric = 'AUPRC' and evaluation in ('Test','Validation') ) AS auprcResult ON results.performance_id = auprcResult.performance_id  LEFT JOIN (SELECT performance_id, value AS calibration_in_large FROM @schema.@plp_table_appendevaluation_statistics where metric = 'calibrationInLarge intercept' and evaluation in ('Test','Validation') ) AS CalibrationInLargeResult ON results.performance_id = CalibrationInLargeResult.performance_id  LEFT JOIN (SELECT performance_id, sum(value) AS population_size FROM @schema.@plp_table_appendevaluation_statistics where metric = 'populationSize' and evaluation in ('Test','Train','Validation') group by performance_id) AS nResult ON results.performance_id = nResult.performance_id LEFT JOIN (SELECT performance_id, sum(value) AS outcome_count FROM @schema.@plp_table_appendevaluation_statistics where metric = 'outcomeCount' and evaluation in ('Test','Train','Validation') group by performance_id) AS oResult ON results.performance_id = oResult.performance_id     LEFT JOIN (SELECT performance_id, value AS test_size FROM @schema.@plp_table_appendevaluation_statistics where metric = 'populationSize' and evaluation in ('Test','Validation')) AS nTest ON results.performance_id = nTest.performance_id;"
"phevaluator-main.R","532","533","SELECT * FROM @schema.@pv_table_prefixALGORITHM_PERFORMANCE_RESULTS  ;"
"phevaluator-main.R","560","561","SELECT * FROM @schema.@pv_table_prefixCOHORT_DEFINITION_SET  ;"
"phevaluator-main.R","577","578","SELECT * FROM @schema.@pv_table_prefixDIAGNOSTICS  ;"
"phevaluator-main.R","593","594","SELECT * FROM @schema.@pv_table_prefixEVALUATION_INPUT_PARAMETERS  ;"
"phevaluator-main.R","609","610","SELECT * FROM @schema.@pv_table_prefixMODEL_COVARIATES  ;"
"phevaluator-main.R","633","634","SELECT * FROM @schema.@pv_table_prefixMODEL_COVARIATE_SUMMARY  ;"
"phevaluator-main.R","666","667","SELECT * FROM @schema.@pv_table_prefixMODEL_INPUT_PARAMETERS  ;"
"phevaluator-main.R","682","683","SELECT * FROM @schema.@pv_table_prefixMODEL_PERFORMANCE  ;"
"phevaluator-main.R","698","699","SELECT * FROM @schema.@pv_table_prefixTEST_SUBJECTS  ;"
"phevaluator-main.R","714","715","SELECT * FROM @schema.@pv_table_prefixTEST_SUBJECTS_COVARIATES  ;"
"report-main.R","772","772","select distinct * from @schema.@cg_table_prefixcohort_definition order by cohort_name;"
"report-main.R","843","911","select distinct tid, oid from (  {@characterization} ? { select distinct TARGET_COHORT_ID as tid, OUTCOME_COHORT_ID as oid from @schema.@c_table_prefixcohort_details where TARGET_COHORT_ID != 0 and OUTCOME_COHORT_ID != 0  }  {@cohort_incidence} ? { {@characterization}?{union} select distinct TARGET_COHORT_DEFINITION_ID as tid, OUTCOME_COHORT_DEFINITION_ID as oid from @schema.@ci_table_prefixincidence_summary  }  {@cohort_method} ? { {@cohort_incidence | @characterization}?{union} select distinct TARGET_ID as tid, OUTCOME_ID as oid from @schema.@cm_table_prefixtarget_comparator_outcome where OUTCOME_OF_INTEREST = 1  }  {@prediction} ? { {@cohort_method | @cohort_incidence | @characterization}?{union}  select distinct c1.cohort_definition_id as tid, c2.cohort_definition_id as oid from @schema.@plp_table_prefixmodel_designs md inner join @schema.@plp_table_prefixcohorts c1 on c1.cohort_id = md.target_id inner join @schema.@plp_table_prefixcohorts c2 on c2.cohort_id = md.outcome_id }  {@sccs} ? { {@cohort_method | @cohort_incidence | @characterization | @prediction}?{union}  SELECT distinct cov.era_id as tid, eos.outcome_id as oid  FROM @schema.@sccs_table_prefixdiagnostics_summary ds  inner join @schema.@sccs_table_prefixexposures_outcome_set eos on ds.exposures_outcome_set_id = eos.exposures_outcome_set_id  INNER JOIN @schema.@sccs_table_prefixcovariate cov on cov.covariate_id = ds.covariate_id and cov.exposures_outcome_set_id = ds.exposures_outcome_set_id and cov.analysis_id = ds.analysis_id and cov.database_id = ds.database_id  -- adding code to remove the negative controls INNER JOIN @schema.@sccs_table_prefixexposure e ON e.exposures_outcome_set_id = ds.exposures_outcome_set_id AND e.era_id = cov.era_id where e.true_effect_size is NULL  }  ) temp_t_o    ;"
